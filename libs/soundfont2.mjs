/* esm.sh - soundfont2@0.5.0 */
var q=Object.create;var H=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty;var Y=(g,o)=>()=>(o||g((o={exports:{}}).exports,o),o.exports);var $=(g,o,e,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let t of Q(o))!X.call(g,t)&&t!==e&&H(g,t,{get:()=>o[t],enumerable:!(r=W(o,t))||r.enumerable});return g};var ee=(g,o,e)=>(e=g!=null?q(J(g)):{},$(o||!g||!g.__esModule?H(e,"default",{value:g,enumerable:!0}):e,g));var Z=Y((P,U)=>{(function(g,o){typeof P=="object"&&typeof U=="object"?U.exports=o():typeof define=="function"&&define.amd?define("SoundFont2",[],o):typeof P=="object"?P.SoundFont2=o():g.SoundFont2=o()})(window,function(){return function(g){var o={};function e(r){if(o[r])return o[r].exports;var t=o[r]={i:r,l:!1,exports:{}};return g[r].call(t.exports,t,t.exports,e),t.l=!0,t.exports}return e.m=g,e.c=o,e.d=function(r,t,i){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:i})},e.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t||4&t&&typeof r=="object"&&r&&r.__esModule)return r;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:r}),2&t&&typeof r!="string")for(var f in r)e.d(i,f,function(n){return r[n]}.bind(null,f));return i},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s="./src/index.ts")}({"./src/chunk.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"SF2Chunk",function(){return s});var r=e("./src/riff/index.ts"),t=e("./src/constants.ts"),i=e("./src/chunks/index.ts");function f(u){return(f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(u)}function n(u,a){for(var l=0;l<a.length;l++){var c=a[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(u,c.key,c)}}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(u)}function p(u,a){return(p=Object.setPrototypeOf||function(l,c){return l.__proto__=c,l})(u,a)}function y(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}var s=function(u){function a(h){var m,E,b,S,k,O;return function(T,I){if(!(T instanceof I))throw new TypeError("Cannot call a class as a function")}(this,a),E=this,m=!(b=d(a).call(this,h.id,h.length,h.buffer,h.subChunks))||f(b)!=="object"&&typeof b!="function"?y(E):b,S=y(y(m)),O=void 0,(k="subChunks")in S?Object.defineProperty(S,k,{value:O,enumerable:!0,configurable:!0,writable:!0}):S[k]=O,m.subChunks=h.subChunks.map(function(T){return new a(T)}),m}var l,c,v;return function(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(m&&m.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),m&&p(h,m)}(a,u),l=a,(c=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new r.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var h=this.subChunks.reduce(function(m,E){if(E.id==="ifil"||E.id==="iver"){if(E.length!==t.SF_VERSION_LENGTH)throw new r.ParseError("Invalid size for the '".concat(E.id,"' sub-chunk"));m[E.id]="".concat(E.getInt16(),".").concat(E.getInt16(2))}else m[E.id]=E.getString();return m},{});if(!h.ifil)throw new r.ParseError("Missing required 'ifil' sub-chunk");if(!h.INAM)throw new r.ParseError("Missing required 'INAM' sub-chunk");return{version:h.ifil,soundEngine:h.isng||"EMU8000",name:h.INAM,rom:h.irom,romVersion:h.iver,creationDate:h.ICRD,author:h.IENG,product:h.IPRD,copyright:h.ICOP,comments:h.ICMT,createdBy:h.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new r.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var h=this.subChunks[0];if(h.id!=="smpl")throw new r.ParseError("Invalid chunk signature","'smpl'","'".concat(h.id,"'"));return h.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new r.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(i.getPresetHeaders)(this.subChunks[0]),presetZones:Object(i.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(i.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(i.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(i.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(i.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(i.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(i.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(i.getSampleHeaders)(this.subChunks[8])}}}])&&n(l.prototype,c),v&&n(l,v),a}(r.RIFFChunk)},"./src/chunks/generators.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getGenerators",function(){return p});var r=e("./src/riff/index.ts"),t=e("./src/types/index.ts"),i=e("./src/constants.ts"),f=[t.GeneratorType.StartAddrsOffset,t.GeneratorType.EndAddrsOffset,t.GeneratorType.StartLoopAddrsOffset,t.GeneratorType.EndLoopAddrsOffset,t.GeneratorType.StartAddrsCoarseOffset,t.GeneratorType.EndAddrsCoarseOffset,t.GeneratorType.StartLoopAddrsCoarseOffset,t.GeneratorType.KeyNum,t.GeneratorType.Velocity,t.GeneratorType.EndLoopAddrsCoarseOffset,t.GeneratorType.SampleModes,t.GeneratorType.ExclusiveClass,t.GeneratorType.OverridingRootKey],n=[t.GeneratorType.Unused1,t.GeneratorType.Unused2,t.GeneratorType.Unused3,t.GeneratorType.Unused4,t.GeneratorType.Reserved1,t.GeneratorType.Reserved2,t.GeneratorType.Reserved3],d=[t.GeneratorType.KeyRange,t.GeneratorType.VelRange],p=function(y,s){if(y.id!==s)throw new r.ParseError("Unexpected chunk ID","'".concat(s,"'"),"'".concat(y.id,"'"));if(y.length%i.SF_GENERATOR_SIZE)throw new r.ParseError("Invalid size for the '".concat(s,"' sub-chunk"));return y.iterate(function(u){var a=u.getInt16();return t.GeneratorType[a]?s==="pgen"&&f.includes(a)||s==="igen"&&n.includes(a)?null:d.includes(a)?{id:a,range:{lo:u.getByte(),hi:u.getByte()}}:{id:a,value:u.getInt16BE()}:null})}},"./src/chunks/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/chunks/instruments/index.ts");e.d(o,"getInstrumentHeaders",function(){return r.getInstrumentHeaders});var t=e("./src/chunks/presets/index.ts");e.d(o,"getPresetHeaders",function(){return t.getPresetHeaders});var i=e("./src/chunks/samples/index.ts");e.d(o,"getSampleHeaders",function(){return i.getSampleHeaders});var f=e("./src/chunks/generators.ts");e.d(o,"getGenerators",function(){return f.getGenerators});var n=e("./src/chunks/modulators.ts");e.d(o,"getModulators",function(){return n.getModulators});var d=e("./src/chunks/zones.ts");e.d(o,"getZones",function(){return d.getZones}),e.d(o,"getItemsInZone",function(){return d.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getInstrumentHeaders",function(){return i});var r=e("./src/riff/index.ts"),t=e("./src/constants.ts"),i=function(f){if(f.id!=="inst")throw new r.ParseError("Unexpected chunk ID","'inst'","'".concat(f.id,"'"));if(f.length%t.SF_INSTRUMENT_HEADER_SIZE)throw new r.ParseError("Invalid size for the 'inst' sub-chunk");return f.iterate(function(n){return{name:n.getString(),bagIndex:n.getInt16()}})}},"./src/chunks/instruments/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/chunks/instruments/headers.ts");e.d(o,"getInstrumentHeaders",function(){return r.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getModulators",function(){return f});var r=e("./src/riff/index.ts"),t=e("./src/constants.ts"),i=function(n){return{type:n>>10&63,polarity:n>>9&1,direction:n>>8&1,palette:n>>7&1,index:127&n}},f=function(n,d){if(n.id!==d)throw new r.ParseError("Unexpected chunk ID","'".concat(d,"'"),"'".concat(n.id,"'"));if(n.length%t.SF_MODULATOR_SIZE)throw new r.ParseError("Invalid size for the '".concat(d,"' sub-chunk"));return n.iterate(function(p){return{source:i(p.getInt16BE()),id:p.getInt16BE(),value:p.getInt16BE(),valueSource:i(p.getInt16BE()),transform:p.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getPresetHeaders",function(){return i});var r=e("./src/riff/index.ts"),t=e("./src/constants.ts"),i=function(f){if(f.id!=="phdr")throw new r.ParseError("Invalid chunk ID","'phdr'","'".concat(f.id,"'"));if(f.length%t.SF_PRESET_HEADER_SIZE)throw new r.ParseError("Invalid size for the 'phdr' sub-chunk");return f.iterate(function(n){return{name:n.getString(),preset:n.getInt16(),bank:n.getInt16(),bagIndex:n.getInt16(),library:n.getUInt32(),genre:n.getUInt32(),morphology:n.getUInt32()}})}},"./src/chunks/presets/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/chunks/presets/headers.ts");e.d(o,"getPresetHeaders",function(){return r.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getSampleHeaders",function(){return i});var r=e("./src/riff/index.ts"),t=e("./src/constants.ts"),i=function(f){if(f.id!=="shdr")throw new r.ParseError("Unexpected chunk ID","'shdr'","'".concat(f.id,"'"));if(f.length%t.SF_SAMPLE_HEADER_SIZE)throw new r.ParseError("Invalid size for the 'shdr' sub-chunk");return f.iterate(function(n){return{name:n.getString(),start:n.getUInt32(),end:n.getUInt32(),startLoop:n.getUInt32(),endLoop:n.getUInt32(),sampleRate:n.getUInt32(),originalPitch:n.getByte(),pitchCorrection:n.getChar(),link:n.getInt16(),type:n.getInt16()}})}},"./src/chunks/samples/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/chunks/samples/headers.ts");e.d(o,"getSampleHeaders",function(){return r.getSampleHeaders})},"./src/chunks/zones.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getZones",function(){return f}),e.d(o,"getItemsInZone",function(){return n});var r=e("./src/riff/index.ts"),t=e("./src/constants.ts"),i=e("./src/types/index.ts"),f=function(s,u){if(s.id!==u)throw new r.ParseError("Unexpected chunk ID","'".concat(u,"'"),"'".concat(s.id,"'"));if(s.length%t.SF_BAG_SIZE)throw new r.ParseError("Invalid size for the '".concat(u,"' sub-chunk"));return s.iterate(function(a){return{generatorIndex:a.getInt16(),modulatorIndex:a.getInt16()}})},n=function(s,u,a,l,c,v){for(var h=[],m=0;m<s.length;m++){for(var E=s[m],b=s[m+1],S=E.bagIndex,k=b?b.bagIndex:u.length,O=[],T=void 0,I=S;I<k;I++){var A=d(I,u,a),C=p(I,u,l),R=C[i.GeneratorType.KeyRange]&&C[i.GeneratorType.KeyRange].range,F=C[v];if(F){var _=c[F.value];_&&O.push({keyRange:R,modulators:A,generators:C,reference:_})}else I-S==0&&(T={keyRange:R,modulators:A,generators:C})}h.push({header:E,globalZone:T,zones:O})}return h},d=function(s,u,a){var l=u[s],c=u[s+1],v=l.modulatorIndex,h=c?c.modulatorIndex:u.length;return y(v,h,a)},p=function(s,u,a){var l=u[s],c=u[s+1],v=l.generatorIndex,h=c?c.generatorIndex:u.length;return y(v,h,a)},y=function(s,u,a){for(var l={},c=s;c<u;c++){var v=a[c];v&&(l[v.id]=v)}return l}},"./src/constants.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"SF_VERSION_LENGTH",function(){return r}),e.d(o,"SF_PRESET_HEADER_SIZE",function(){return t}),e.d(o,"SF_BAG_SIZE",function(){return i}),e.d(o,"SF_MODULATOR_SIZE",function(){return f}),e.d(o,"SF_GENERATOR_SIZE",function(){return n}),e.d(o,"SF_INSTRUMENT_HEADER_SIZE",function(){return d}),e.d(o,"SF_SAMPLE_HEADER_SIZE",function(){return p}),e.d(o,"DEFAULT_SAMPLE_RATE",function(){return y});var r=4,t=38,i=4,f=10,n=4,d=22,p=46,y=22050},"./src/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/types/index.ts");for(var t in r)["default"].indexOf(t)<0&&function(d){e.d(o,d,function(){return r[d]})}(t);var i=e("./src/chunk.ts");e.d(o,"SF2Chunk",function(){return i.SF2Chunk});var f=e("./src/constants.ts");e.d(o,"SF_VERSION_LENGTH",function(){return f.SF_VERSION_LENGTH}),e.d(o,"SF_PRESET_HEADER_SIZE",function(){return f.SF_PRESET_HEADER_SIZE}),e.d(o,"SF_BAG_SIZE",function(){return f.SF_BAG_SIZE}),e.d(o,"SF_MODULATOR_SIZE",function(){return f.SF_MODULATOR_SIZE}),e.d(o,"SF_GENERATOR_SIZE",function(){return f.SF_GENERATOR_SIZE}),e.d(o,"SF_INSTRUMENT_HEADER_SIZE",function(){return f.SF_INSTRUMENT_HEADER_SIZE}),e.d(o,"SF_SAMPLE_HEADER_SIZE",function(){return f.SF_SAMPLE_HEADER_SIZE}),e.d(o,"DEFAULT_SAMPLE_RATE",function(){return f.DEFAULT_SAMPLE_RATE});var n=e("./src/soundFont2.ts");e.d(o,"SoundFont2",function(){return n.SoundFont2})},"./src/riff/chunkIterator.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"ChunkIterator",function(){return n});var r=e("./src/utils/index.ts");function t(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function i(d,p){for(var y=0;y<p.length;y++){var s=p[y];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(d,s.key,s)}}function f(d,p,y){return p in d?Object.defineProperty(d,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):d[p]=y,d}var n=function(){function d(u){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;t(this,d),f(this,"target",[]),f(this,"chunk",void 0),f(this,"position",0),this.chunk=u,this.position=a}var p,y,s;return p=d,(y=[{key:"iterate",value:function(u){for(;this.position<this.chunk.length;){var a=u(this);a&&this.target.push(a)}}},{key:"getString",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,a=Object(r.getStringFromBuffer)(this.getBuffer(this.position,u));return this.position+=u,a}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(u){this.position+=u}},{key:"getBuffer",value:function(u,a){return this.chunk.buffer.subarray(u,u+a)}},{key:"currentPosition",get:function(){return this.position}}])&&i(p.prototype,y),s&&i(p,s),d}()},"./src/riff/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/riff/chunkIterator.ts");e.d(o,"ChunkIterator",function(){return r.ChunkIterator});var t=e("./src/riff/parseError.ts");e.d(o,"ParseError",function(){return t.ParseError});var i=e("./src/riff/parser.ts");e.d(o,"parseBuffer",function(){return i.parseBuffer}),e.d(o,"getChunk",function(){return i.getChunk}),e.d(o,"getChunkLength",function(){return i.getChunkLength}),e.d(o,"getSubChunks",function(){return i.getSubChunks}),e.d(o,"getChunkId",function(){return i.getChunkId});var f=e("./src/riff/riffChunk.ts");e.d(o,"RIFFChunk",function(){return f.RIFFChunk})},"./src/riff/parseError.ts":function(g,o,e){"use strict";function r(s){return(r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(s)}function t(s,u){return!u||r(u)!=="object"&&typeof u!="function"?function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(s):u}function i(s){var u=typeof Map=="function"?new Map:void 0;return(i=function(a){if(a===null||(l=a,Function.toString.call(l).indexOf("[native code]")===-1))return a;var l;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(u!==void 0){if(u.has(a))return u.get(a);u.set(a,c)}function c(){return n(a,arguments,p(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),d(c,a)})(s)}function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function n(s,u,a){return(n=f()?Reflect.construct:function(l,c,v){var h=[null];h.push.apply(h,c);var m=new(Function.bind.apply(l,h));return v&&d(m,v.prototype),m}).apply(null,arguments)}function d(s,u){return(d=Object.setPrototypeOf||function(a,l){return a.__proto__=l,a})(s,u)}function p(s){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(s)}e.r(o),e.d(o,"ParseError",function(){return y});var y=function(s){function u(a,l,c){return function(v,h){if(!(v instanceof h))throw new TypeError("Cannot call a class as a function")}(this,u),t(this,p(u).call(this,"".concat(a).concat(l&&c?", expected ".concat(l,", received ").concat(c):"")))}return function(a,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(l&&l.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),l&&d(a,l)}(u,s),u}(i(Error))},"./src/riff/parser.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"parseBuffer",function(){return f}),e.d(o,"getChunk",function(){return n}),e.d(o,"getChunkLength",function(){return d}),e.d(o,"getSubChunks",function(){return p}),e.d(o,"getChunkId",function(){return y});var r=e("./src/riff/parseError.ts"),t=e("./src/utils/buffer.ts"),i=e("./src/riff/riffChunk.ts"),f=function(s){var u=y(s);if(u!=="RIFF")throw new r.ParseError("Invalid file format","RIFF",u);var a=y(s,8);if(a!=="sfbk")throw new r.ParseError("Invalid signature","sfbk",a);var l=s.subarray(8),c=p(l.subarray(4));return new i.RIFFChunk(u,l.length,l,c)},n=function(s,u){var a=y(s,u),l=d(s,u+4),c=[];return a!=="RIFF"&&a!=="LIST"||(c=p(s.subarray(u+12))),new i.RIFFChunk(a,l,s.subarray(u+8),c)},d=function(s,u){return((s=s.subarray(u,u+4))[0]|s[1]<<8|s[2]<<16|s[3]<<24)>>>0},p=function(s){for(var u=[],a=0;a<=s.length-8;){var l=n(s,a);u.push(l),a=(a+=8+l.length)%2?a+1:a}return u},y=function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(t.getStringFromBuffer)(s.subarray(u,u+4))}},"./src/riff/riffChunk.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"RIFFChunk",function(){return n});var r=e("./src/riff/chunkIterator.ts"),t=e("./src/utils/index.ts");function i(d,p){for(var y=0;y<p.length;y++){var s=p[y];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(d,s.key,s)}}function f(d,p,y){return p in d?Object.defineProperty(d,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):d[p]=y,d}var n=function(){function d(u,a,l,c){(function(v,h){if(!(v instanceof h))throw new TypeError("Cannot call a class as a function")})(this,d),f(this,"id",void 0),f(this,"length",void 0),f(this,"buffer",void 0),f(this,"subChunks",void 0),this.id=u,this.length=a,this.buffer=l,this.subChunks=c}var p,y,s;return p=d,(y=[{key:"getString",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1?arguments[1]:void 0;return Object(t.getStringFromBuffer)(this.getBuffer(u,a||this.length-u))}},{key:"getInt16",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[u++]|this.buffer[u]<<8}},{key:"getUInt32",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[u++]|this.buffer[u++]<<8|this.buffer[u++]<<16|this.buffer[u]<<24)>>>0}},{key:"getByte",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[u]}},{key:"getChar",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[u]<<24>>24}},{key:"iterator",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new r.ChunkIterator(this,u)}},{key:"iterate",value:function(u){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=new r.ChunkIterator(this,a);return l.iterate(u),l.target}},{key:"getBuffer",value:function(u,a){return this.buffer.subarray(u,u+a)}}])&&i(p.prototype,y),s&&i(p,s),d}()},"./src/soundFont2.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"SoundFont2",function(){return u});var r=e("./src/types/index.ts"),t=e("./src/chunk.ts"),i=e("./src/riff/index.ts"),f=e("./src/chunks/index.ts"),n=e("./src/utils/index.ts");function d(a){for(var l=1;l<arguments.length;l++){var c=arguments[l]!=null?arguments[l]:{},v=Object.keys(c);typeof Object.getOwnPropertySymbols=="function"&&(v=v.concat(Object.getOwnPropertySymbols(c).filter(function(h){return Object.getOwnPropertyDescriptor(c,h).enumerable}))),v.forEach(function(h){s(a,h,c[h])})}return a}function p(a,l){for(var c=0;c<l.length;c++){var v=l[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(a,v.key,v)}}function y(a,l,c){return l&&p(a.prototype,l),c&&p(a,c),a}function s(a,l,c){return l in a?Object.defineProperty(a,l,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[l]=c,a}var u=function(){function a(l){if(function(v,h){if(!(v instanceof h))throw new TypeError("Cannot call a class as a function")}(this,a),s(this,"chunk",void 0),s(this,"metaData",void 0),s(this,"sampleData",void 0),s(this,"samples",void 0),s(this,"presetData",void 0),s(this,"instruments",void 0),s(this,"presets",void 0),s(this,"banks",void 0),!(l instanceof t.SF2Chunk)){var c=Object(i.parseBuffer)(l);l=new t.SF2Chunk(c)}if(l.subChunks.length!==3)throw new i.ParseError("Invalid sfbk structure","3 chunks","".concat(l.subChunks.length," chunks"));this.chunk=l,this.metaData=l.subChunks[0].getMetaData(),this.sampleData=l.subChunks[1].getSampleData(),this.presetData=l.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return y(a,null,[{key:"from",value:function(l){return new a(l)}}]),y(a,[{key:"getKeyData",value:function(l){var c=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(n.memoize)(function(m,E,b){var S=c.banks[E];if(S){var k=S.presets[b];if(k){var O=k.zones.filter(function(L){return c.isKeyInRange(L,m)});if(O.length>0){var T=!0,I=!1,A=void 0;try{for(var C,R=O[Symbol.iterator]();!(T=(C=R.next()).done);T=!0){var F=C.value,_=F.instrument,G=_.zones.filter(function(L){return c.isKeyInRange(L,m)});if(G.length>0){var D=!0,N=!1,V=void 0;try{for(var j,M=G[Symbol.iterator]();!(D=(j=M.next()).done);D=!0){var w=j.value,B=w.sample,K=d({},F.generators,w.generators),z=d({},F.modulators,w.modulators);return{keyNumber:m,preset:k,instrument:_,sample:B,generators:K,modulators:z}}}catch(L){N=!0,V=L}finally{try{D||M.return==null||M.return()}finally{if(N)throw V}}}}}catch(L){I=!0,A=L}finally{try{T||R.return==null||R.return()}finally{if(I)throw A}}}}}return null})(l,v,h)}},{key:"isKeyInRange",value:function(l,c){return l.keyRange===void 0||l.keyRange.lo<=c&&l.keyRange.hi>=c}},{key:"getBanks",value:function(){return this.presets.reduce(function(l,c){var v=c.header.bank;return l[v]||(l[v]={presets:[]}),l[v].presets[c.header.preset]=c,l},[])}},{key:"getPresets",value:function(){var l=this.presetData,c=l.presetHeaders,v=l.presetZones,h=l.presetGenerators,m=l.presetModulators;return Object(f.getItemsInZone)(c,v,m,h,this.instruments,r.GeneratorType.Instrument).filter(function(E){return E.header.name!=="EOP"}).map(function(E){return{header:E.header,globalZone:E.globalZone,zones:E.zones.map(function(b){return{keyRange:b.keyRange,generators:b.generators,modulators:b.modulators,instrument:b.reference}})}})}},{key:"getInstruments",value:function(){var l=this.presetData,c=l.instrumentHeaders,v=l.instrumentZones,h=l.instrumentModulators,m=l.instrumentGenerators;return Object(f.getItemsInZone)(c,v,h,m,this.samples,r.GeneratorType.SampleId).filter(function(E){return E.header.name!=="EOI"}).map(function(E){return{header:E.header,globalZone:E.globalZone,zones:E.zones.map(function(b){return{keyRange:b.keyRange,generators:b.generators,modulators:b.modulators,sample:b.reference}})}})}},{key:"getSamples",value:function(){var l=this;return this.presetData.sampleHeaders.filter(function(c){return c.name!=="EOS"}).map(function(c){if(c.name!=="EOS"&&c.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(c.sampleRate," hz in sample '").concat(c.name,"'"));return c.originalPitch>=128&&c.originalPitch<=254&&(c.originalPitch=60),c.startLoop-=c.start,c.endLoop-=c.start,{header:c,data:new Int16Array(new Uint8Array(l.sampleData.subarray(2*c.start,2*c.end)).buffer)}})}}]),a}()},"./src/types/bank.ts":function(g,o){},"./src/types/generator.ts":function(g,o,e){"use strict";var r,t;function i(n,d,p){return d in n?Object.defineProperty(n,d,{value:p,enumerable:!0,configurable:!0,writable:!0}):n[d]=p,n}e.r(o),e.d(o,"GeneratorType",function(){return t}),e.d(o,"DEFAULT_GENERATOR_VALUES",function(){return f}),function(n){n[n.StartAddrsOffset=0]="StartAddrsOffset",n[n.EndAddrsOffset=1]="EndAddrsOffset",n[n.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",n[n.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",n[n.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",n[n.ModLFOToPitch=5]="ModLFOToPitch",n[n.VibLFOToPitch=6]="VibLFOToPitch",n[n.ModEnvToPitch=7]="ModEnvToPitch",n[n.InitialFilterFc=8]="InitialFilterFc",n[n.InitialFilterQ=9]="InitialFilterQ",n[n.ModLFOToFilterFc=10]="ModLFOToFilterFc",n[n.ModEnvToFilterFc=11]="ModEnvToFilterFc",n[n.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",n[n.ModLFOToVolume=13]="ModLFOToVolume",n[n.Unused1=14]="Unused1",n[n.ChorusEffectsSend=15]="ChorusEffectsSend",n[n.ReverbEffectsSend=16]="ReverbEffectsSend",n[n.Pan=17]="Pan",n[n.Unused2=18]="Unused2",n[n.Unused3=19]="Unused3",n[n.Unused4=20]="Unused4",n[n.DelayModLFO=21]="DelayModLFO",n[n.FreqModLFO=22]="FreqModLFO",n[n.DelayVibLFO=23]="DelayVibLFO",n[n.FreqVibLFO=24]="FreqVibLFO",n[n.DelayModEnv=25]="DelayModEnv",n[n.AttackModEnv=26]="AttackModEnv",n[n.HoldModEnv=27]="HoldModEnv",n[n.DecayModEnv=28]="DecayModEnv",n[n.SustainModEnv=29]="SustainModEnv",n[n.ReleaseModEnv=30]="ReleaseModEnv",n[n.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",n[n.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",n[n.DelayVolEnv=33]="DelayVolEnv",n[n.AttackVolEnv=34]="AttackVolEnv",n[n.HoldVolEnv=35]="HoldVolEnv",n[n.DecayVolEnv=36]="DecayVolEnv",n[n.SustainVolEnv=37]="SustainVolEnv",n[n.ReleaseVolEnv=38]="ReleaseVolEnv",n[n.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",n[n.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",n[n.Instrument=41]="Instrument",n[n.Reserved1=42]="Reserved1",n[n.KeyRange=43]="KeyRange",n[n.VelRange=44]="VelRange",n[n.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",n[n.KeyNum=46]="KeyNum",n[n.Velocity=47]="Velocity",n[n.InitialAttenuation=48]="InitialAttenuation",n[n.Reserved2=49]="Reserved2",n[n.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",n[n.CoarseTune=51]="CoarseTune",n[n.FineTune=52]="FineTune",n[n.SampleId=53]="SampleId",n[n.SampleModes=54]="SampleModes",n[n.Reserved3=55]="Reserved3",n[n.ScaleTuning=56]="ScaleTuning",n[n.ExclusiveClass=57]="ExclusiveClass",n[n.OverridingRootKey=58]="OverridingRootKey",n[n.Unused5=59]="Unused5",n[n.EndOper=60]="EndOper"}(t||(t={}));var f=(i(r={},t.StartAddrsOffset,0),i(r,t.EndAddrsOffset,0),i(r,t.StartLoopAddrsOffset,0),i(r,t.EndLoopAddrsOffset,0),i(r,t.StartAddrsCoarseOffset,0),i(r,t.ModLFOToPitch,0),i(r,t.VibLFOToPitch,0),i(r,t.ModEnvToPitch,0),i(r,t.InitialFilterFc,13500),i(r,t.InitialFilterQ,0),i(r,t.ModLFOToFilterFc,0),i(r,t.ModEnvToFilterFc,0),i(r,t.EndAddrsCoarseOffset,0),i(r,t.ModLFOToVolume,0),i(r,t.ChorusEffectsSend,0),i(r,t.ReverbEffectsSend,0),i(r,t.Pan,0),i(r,t.DelayModLFO,-12e3),i(r,t.FreqModLFO,0),i(r,t.DelayVibLFO,-12e3),i(r,t.FreqVibLFO,0),i(r,t.DelayModEnv,-12e3),i(r,t.AttackModEnv,-12e3),i(r,t.HoldModEnv,-12e3),i(r,t.DecayModEnv,-12e3),i(r,t.SustainModEnv,0),i(r,t.ReleaseModEnv,-12e3),i(r,t.KeyNumToModEnvHold,0),i(r,t.KeyNumToModEnvDecay,0),i(r,t.DelayVolEnv,-12e3),i(r,t.AttackVolEnv,-12e3),i(r,t.HoldVolEnv,-12e3),i(r,t.DecayVolEnv,-12e3),i(r,t.SustainVolEnv,0),i(r,t.ReleaseVolEnv,-12e3),i(r,t.KeyNumToVolEnvHold,0),i(r,t.KeyNumToVolEnvDecay,0),i(r,t.StartLoopAddrsCoarseOffset,0),i(r,t.KeyNum,-1),i(r,t.Velocity,-1),i(r,t.InitialAttenuation,0),i(r,t.EndLoopAddrsCoarseOffset,0),i(r,t.CoarseTune,0),i(r,t.FineTune,0),i(r,t.SampleModes,0),i(r,t.ScaleTuning,100),i(r,t.ExclusiveClass,0),i(r,t.OverridingRootKey,-1),r)},"./src/types/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/types/bank.ts");for(var t in r)["default"].indexOf(t)<0&&function(l){e.d(o,l,function(){return r[l]})}(t);var i=e("./src/types/generator.ts");e.d(o,"GeneratorType",function(){return i.GeneratorType}),e.d(o,"DEFAULT_GENERATOR_VALUES",function(){return i.DEFAULT_GENERATOR_VALUES});var f=e("./src/types/instrument.ts");for(var t in f)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(t)<0&&function(c){e.d(o,c,function(){return f[c]})}(t);var n=e("./src/types/key.ts");for(var t in n)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(t)<0&&function(c){e.d(o,c,function(){return n[c]})}(t);var d=e("./src/types/metaData.ts");for(var t in d)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(t)<0&&function(c){e.d(o,c,function(){return d[c]})}(t);var p=e("./src/types/modulator.ts");e.d(o,"ControllerType",function(){return p.ControllerType}),e.d(o,"ControllerPolarity",function(){return p.ControllerPolarity}),e.d(o,"ControllerDirection",function(){return p.ControllerDirection}),e.d(o,"ControllerPalette",function(){return p.ControllerPalette}),e.d(o,"Controller",function(){return p.Controller}),e.d(o,"TransformType",function(){return p.TransformType}),e.d(o,"DEFAULT_INSTRUMENT_MODULATORS",function(){return p.DEFAULT_INSTRUMENT_MODULATORS});var y=e("./src/types/preset.ts");for(var t in y)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(t)<0&&function(c){e.d(o,c,function(){return y[c]})}(t);var s=e("./src/types/presetData.ts");for(var t in s)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(t)<0&&function(c){e.d(o,c,function(){return s[c]})}(t);var u=e("./src/types/sample.ts");e.d(o,"SampleType",function(){return u.SampleType});var a=e("./src/types/zone.ts");for(var t in a)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType"].indexOf(t)<0&&function(c){e.d(o,c,function(){return a[c]})}(t)},"./src/types/instrument.ts":function(g,o){},"./src/types/key.ts":function(g,o){},"./src/types/metaData.ts":function(g,o){},"./src/types/modulator.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"ControllerType",function(){return r}),e.d(o,"ControllerPolarity",function(){return t}),e.d(o,"ControllerDirection",function(){return i}),e.d(o,"ControllerPalette",function(){return f}),e.d(o,"Controller",function(){return n}),e.d(o,"TransformType",function(){return d}),e.d(o,"DEFAULT_INSTRUMENT_MODULATORS",function(){return y});var r,t,i,f,n,d,p=e("./src/types/generator.ts");(function(s){s[s.Linear=0]="Linear",s[s.Concave=1]="Concave",s[s.Convex=2]="Convex",s[s.Switch=3]="Switch"})(r||(r={})),function(s){s[s.Unipolar=0]="Unipolar",s[s.Bipolar=1]="Bipolar"}(t||(t={})),function(s){s[s.Increasing=0]="Increasing",s[s.Decreasing=1]="Decreasing"}(i||(i={})),function(s){s[s.GeneralController=0]="GeneralController",s[s.MidiController=1]="MidiController"}(f||(f={})),function(s){s[s.NoController=0]="NoController",s[s.NoteOnVelocity=2]="NoteOnVelocity",s[s.NoteOnKeyNumber=3]="NoteOnKeyNumber",s[s.PolyPressure=10]="PolyPressure",s[s.ChannelPressure=13]="ChannelPressure",s[s.PitchWheel=14]="PitchWheel",s[s.PitchWheelSensitivity=16]="PitchWheelSensitivity",s[s.Link=127]="Link"}(n||(n={})),function(s){s[s.Linear=0]="Linear",s[s.Absolute=2]="Absolute"}(d||(d={}));var y=[{id:p.GeneratorType.InitialAttenuation,source:{type:r.Concave,polarity:t.Unipolar,direction:i.Decreasing,palette:f.GeneralController,index:n.NoteOnVelocity},value:960,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.InitialFilterFc,source:{type:r.Linear,polarity:t.Unipolar,direction:i.Decreasing,palette:f.GeneralController,index:n.NoteOnVelocity},value:-2400,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.VibLFOToPitch,source:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.ChannelPressure},value:50,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.VibLFOToPitch,source:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.MidiController,index:1},value:50,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.InitialAttenuation,source:{type:r.Concave,polarity:t.Unipolar,direction:i.Decreasing,palette:f.MidiController,index:7},value:960,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.InitialAttenuation,source:{type:r.Linear,polarity:t.Bipolar,direction:i.Increasing,palette:f.MidiController,index:10},value:1e3,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.InitialAttenuation,source:{type:r.Concave,polarity:t.Unipolar,direction:i.Decreasing,palette:f.MidiController,index:11},value:960,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.ReverbEffectsSend,source:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.MidiController,index:91},value:200,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.ChorusEffectsSend,source:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.MidiController,index:93},value:200,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.NoController},transform:d.Linear},{id:p.GeneratorType.CoarseTune,source:{type:r.Linear,polarity:t.Bipolar,direction:i.Increasing,palette:f.GeneralController,index:n.PitchWheel},value:12700,valueSource:{type:r.Linear,polarity:t.Unipolar,direction:i.Increasing,palette:f.GeneralController,index:n.PitchWheelSensitivity},transform:d.Linear}]},"./src/types/preset.ts":function(g,o){},"./src/types/presetData.ts":function(g,o){},"./src/types/sample.ts":function(g,o,e){"use strict";var r;e.r(o),e.d(o,"SampleType",function(){return r}),function(t){t[t.EOS=0]="EOS",t[t.Mono=1]="Mono",t[t.Right=2]="Right",t[t.Left=4]="Left",t[t.Linked=8]="Linked",t[t.RomMono=32769]="RomMono",t[t.RomRight=32770]="RomRight",t[t.RomLeft=32772]="RomLeft",t[t.RomLinked=32776]="RomLinked"}(r||(r={}))},"./src/types/zone.ts":function(g,o){},"./src/utils/buffer.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"getStringFromBuffer",function(){return r});var r=function(t){var i=new TextDecoder("utf8").decode(t),f=i.indexOf("\0");return(f===-1?i:i.slice(0,f)).trim()}},"./src/utils/index.ts":function(g,o,e){"use strict";e.r(o);var r=e("./src/utils/buffer.ts");e.d(o,"getStringFromBuffer",function(){return r.getStringFromBuffer});var t=e("./src/utils/memoize.ts");e.d(o,"memoize",function(){return t.memoize})},"./src/utils/memoize.ts":function(g,o,e){"use strict";e.r(o),e.d(o,"memoize",function(){return r});var r=function(t){var i={};return function(){for(var f=arguments.length,n=new Array(f),d=0;d<f;d++)n[d]=arguments[d];var p=JSON.stringify(n);if(p in i)return i[p];var y=t.apply(void 0,n);return i[p]=y,y}}}})})});var x=ee(Z()),te=x.default??x;export{te as default};
//# sourceMappingURL=soundfont2.mjs.map